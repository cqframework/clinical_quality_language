<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion,DisableMethodInvocation" xsi:type="a:CqlToElmInfo"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="368">
         <a:s>library MATGlobalCommonFunctions version '5.0.000'</a:s>
      </a:s>
   </annotation>
   <identifier id="MATGlobalCommonFunctions" version="5.0.000"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="5:1-5:23" localIdentifier="QDM" uri="urn:healthit-gov:qdm:v5_5" version="5.5">
         <annotation xsi:type="a:Annotation">
            <a:s r="1">
               <a:s>/*This is an interim version for use prior to AU 2020 release.  We anticipate another release for inclusion with the program measures in Spring 2020*/using </a:s>
               <a:s>
                  <a:s>QDM</a:s>
               </a:s>
               <a:s> version '5.5'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <parameters>
      <def localId="9" locator="13:1-13:49" name="Measurement Period" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="9">
               <a:s>parameter &quot;Measurement Period&quot; </a:s>
               <a:s r="8">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="7">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
            </a:s>
         </annotation>
         <parameterTypeSpecifier localId="8" locator="13:32-13:49" xsi:type="IntervalTypeSpecifier">
            <pointType localId="7" locator="13:41-13:48" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </parameterTypeSpecifier>
      </def>
   </parameters>
   <valueSets>
      <def localId="2" locator="7:1-7:82" name="Emergency Department Visit" id="urn:oid:2.16.840.1.113883.3.117.1.7.1.292" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>valueset &quot;Emergency Department Visit&quot;: 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="3" locator="8:1-8:71" name="Encounter Inpatient" id="urn:oid:2.16.840.1.113883.3.666.5.307" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>valueset &quot;Encounter Inpatient&quot;: 'urn:oid:2.16.840.1.113883.3.666.5.307'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="9:1-9:72" name="Intensive Care Unit" id="urn:oid:2.16.840.1.113762.1.4.1029.206" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>valueset &quot;Intensive Care Unit&quot;: 'urn:oid:2.16.840.1.113762.1.4.1029.206'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="5" locator="10:1-10:73" name="Observation Services" id="urn:oid:2.16.840.1.113762.1.4.1111.143" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="5">
               <a:s>valueset &quot;Observation Services&quot;: 'urn:oid:2.16.840.1.113762.1.4.1111.143'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="6" locator="11:1-11:78" name="Outpatient Surgery Service" id="urn:oid:2.16.840.1.113762.1.4.1110.38" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="6">
               <a:s>valueset &quot;Outpatient Surgery Service&quot;: 'urn:oid:2.16.840.1.113762.1.4.1110.38'</a:s>
            </a:s>
         </annotation>
      </def>
   </valueSets>
   <contexts>
      <def locator="15:1-15:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="15:1-15:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="15:1-15:15" xmlns:ns0="urn:healthit-gov:qdm:v5_5" dataType="ns0:Patient" templateId="Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="21" locator="50:1-51:60" name="LengthInDays" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="21">
               <a:s>/*calculates the difference in calendar days between the start and end of the given interval.*/define function &quot;LengthInDays&quot;(Value </a:s>
               <a:s r="15">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="14">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="20">
                  <a:s r="20">
                     <a:s>difference in days between </a:s>
                     <a:s r="17">
                        <a:s>start of </a:s>
                        <a:s r="16">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                     <a:s> and </a:s>
                     <a:s r="19">
                        <a:s>end of </a:s>
                        <a:s r="18">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="20" locator="51:3-51:60" precision="Day" xsi:type="DifferenceBetween">
            <operand localId="17" locator="51:30-51:43" xsi:type="Start">
               <operand localId="16" locator="51:39-51:43" name="Value" xsi:type="OperandRef"/>
            </operand>
            <operand localId="19" locator="51:49-51:60" xsi:type="End">
               <operand localId="18" locator="51:56-51:60" name="Value" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="Value">
            <operandTypeSpecifier localId="15" locator="50:38-50:55" xsi:type="IntervalTypeSpecifier">
               <pointType localId="14" locator="50:47-50:54" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="31" locator="17:1-20:74" name="Inpatient Encounter" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="31">
               <a:s>define &quot;Inpatient Encounter&quot;:
  </a:s>
               <a:s r="30">
                  <a:s>
                     <a:s r="11">
                        <a:s r="10">
                           <a:s r="10">
                              <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                              <a:s>
                                 <a:s>&quot;Encounter Inpatient&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> EncounterInpatient</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
  	</a:s>
                  <a:s r="29">
                     <a:s>where </a:s>
                     <a:s r="29">
                        <a:s r="24">
                           <a:s r="22">
                              <a:s>&quot;LengthInDays&quot;(</a:s>
                              <a:s r="13">
                                 <a:s r="12">
                                    <a:s>EncounterInpatient</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="13">
                                    <a:s>relevantPeriod</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s r="23">&lt;= 120</a:s>
                        </a:s>
                        <a:s>
  		and </a:s>
                        <a:s r="28">
                           <a:s r="26">
                              <a:s r="25">
                                 <a:s>EncounterInpatient</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="26">
                                 <a:s>relevantPeriod</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="28"> ends during </a:s>
                           <a:s r="27">
                              <a:s>&quot;Measurement Period&quot;</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="30" locator="18:3-20:74" xsi:type="Query">
            <source localId="11" locator="18:3-18:68" alias="EncounterInpatient">
               <expression localId="10" locator="18:3-18:49" xmlns:ns1="urn:healthit-gov:qdm:v5_5" dataType="ns1:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                  <codes locator="18:28-18:48" name="Encounter Inpatient" xsi:type="ValueSetRef"/>
               </expression>
            </source>
            <where localId="29" locator="19:4-20:74" xsi:type="And">
               <operand localId="24" locator="19:10-19:64" xsi:type="LessOrEqual">
                  <operand localId="22" locator="19:10-19:58" name="LengthInDays" xsi:type="FunctionRef">
                     <operand localId="13" locator="19:25-19:57" path="relevantPeriod" scope="EncounterInpatient" xsi:type="Property"/>
                  </operand>
                  <operand localId="23" locator="19:62-19:64" valueType="t:Integer" value="120" xsi:type="Literal"/>
               </operand>
               <operand localId="28" locator="20:9-20:74" xsi:type="In">
                  <operand locator="20:43-20:46" xsi:type="End">
                     <operand localId="26" locator="20:9-20:41" path="relevantPeriod" scope="EncounterInpatient" xsi:type="Property"/>
                  </operand>
                  <operand localId="27" locator="20:55-20:74" name="Measurement Period" xsi:type="ParameterRef"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="33" locator="22:1-23:56" name="ED Encounter" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="33">
               <a:s>define &quot;ED Encounter&quot;:
  </a:s>
               <a:s r="32">
                  <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                  <a:s>
                     <a:s>&quot;Emergency Department Visit&quot;</a:s>
                  </a:s>
                  <a:s>]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="32" locator="23:3-23:56" xmlns:ns2="urn:healthit-gov:qdm:v5_5" dataType="ns2:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
            <codes locator="23:28-23:55" name="Emergency Department Visit" xsi:type="ValueSetRef"/>
         </expression>
      </def>
      <def localId="41" locator="26:1-27:52" name="CalendarAgeInDaysAt" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="41">
               <a:s>/*CalendarAgeInDaysAt calculates the calendar age (meaning the age without considering time components) in days.*/define function &quot;CalendarAgeInDaysAt&quot;(BirthDateTime </a:s>
               <a:s r="34">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s>, AsOf </a:s>
               <a:s r="35">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="40">
                  <a:s r="40">
                     <a:s>days between </a:s>
                     <a:s r="37">
                        <a:s>ToDate(</a:s>
                        <a:s r="36">
                           <a:s>BirthDateTime</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>and </a:s>
                     <a:s r="39">
                        <a:s>ToDate(</a:s>
                        <a:s r="38">
                           <a:s>AsOf</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="40" locator="27:3-27:52" precision="Day" xsi:type="DurationBetween">
            <operand localId="37" locator="27:16-27:36" xsi:type="ToDate">
               <operand localId="36" locator="27:23-27:35" name="BirthDateTime" xsi:type="OperandRef"/>
            </operand>
            <operand localId="39" locator="27:41-27:52" xsi:type="ToDate">
               <operand localId="38" locator="27:48-27:51" name="AsOf" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="BirthDateTime">
            <operandTypeSpecifier localId="34" locator="26:53-26:60" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="AsOf">
            <operandTypeSpecifier localId="35" locator="26:68-26:75" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="46" locator="30:1-31:45" name="CalendarAgeInDays" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="46">
               <a:s>/*CalendarAgeInDays calculates the calendar age (meaning the age without considering time components) in days as of today*/define function &quot;CalendarAgeInDays&quot;(BirthDateTime </a:s>
               <a:s r="42">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="45">
                  <a:s r="45">
                     <a:s>CalendarAgeInDaysAt(</a:s>
                     <a:s r="43">
                        <a:s>BirthDateTime</a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="44">
                        <a:s>Today()</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="45" locator="31:3-31:45" name="CalendarAgeInDaysAt" xsi:type="FunctionRef">
            <operand localId="43" locator="31:23-31:35" name="BirthDateTime" xsi:type="OperandRef"/>
            <operand xsi:type="ToDateTime">
               <operand localId="44" locator="31:38-31:44" xsi:type="Today"/>
            </operand>
         </expression>
         <operand name="BirthDateTime">
            <operandTypeSpecifier localId="42" locator="30:51-30:58" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="54" locator="34:1-35:54" name="CalendarAgeInMonthsAt" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="54">
               <a:s>/*CalendarAgeInMonthsAt calculates the calendar age (meaning the age without considering time components) in months.*/define function &quot;CalendarAgeInMonthsAt&quot;(BirthDateTime </a:s>
               <a:s r="47">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s>, AsOf </a:s>
               <a:s r="48">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="53">
                  <a:s r="53">
                     <a:s>months between </a:s>
                     <a:s r="50">
                        <a:s>ToDate(</a:s>
                        <a:s r="49">
                           <a:s>BirthDateTime</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>and </a:s>
                     <a:s r="52">
                        <a:s>ToDate(</a:s>
                        <a:s r="51">
                           <a:s>AsOf</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="53" locator="35:3-35:54" precision="Month" xsi:type="DurationBetween">
            <operand localId="50" locator="35:18-35:38" xsi:type="ToDate">
               <operand localId="49" locator="35:25-35:37" name="BirthDateTime" xsi:type="OperandRef"/>
            </operand>
            <operand localId="52" locator="35:43-35:54" xsi:type="ToDate">
               <operand localId="51" locator="35:50-35:53" name="AsOf" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="BirthDateTime">
            <operandTypeSpecifier localId="47" locator="34:55-34:62" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="AsOf">
            <operandTypeSpecifier localId="48" locator="34:70-34:77" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="59" locator="38:1-39:47" name="CalendarAgeInMonths" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="59">
               <a:s>/*CalendarAgeInMonths calculates the calendar age (meaning the age without considering time components) in months as of today.*/define function &quot;CalendarAgeInMonths&quot;(BirthDateTime </a:s>
               <a:s r="55">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="58">
                  <a:s r="58">
                     <a:s>CalendarAgeInMonthsAt(</a:s>
                     <a:s r="56">
                        <a:s>BirthDateTime</a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="57">
                        <a:s>Today()</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="58" locator="39:3-39:47" name="CalendarAgeInMonthsAt" xsi:type="FunctionRef">
            <operand localId="56" locator="39:25-39:37" name="BirthDateTime" xsi:type="OperandRef"/>
            <operand xsi:type="ToDateTime">
               <operand localId="57" locator="39:40-39:46" xsi:type="Today"/>
            </operand>
         </expression>
         <operand name="BirthDateTime">
            <operandTypeSpecifier localId="55" locator="38:53-38:60" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="67" locator="42:1-43:53" name="CalendarAgeInYearsAt" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="67">
               <a:s>/*CalendarAgeInYearsAt calculates the calendar age (meaning the age without considering time components) in years.*/define function &quot;CalendarAgeInYearsAt&quot;(BirthDateTime </a:s>
               <a:s r="60">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s>, AsOf </a:s>
               <a:s r="61">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="66">
                  <a:s r="66">
                     <a:s>years between </a:s>
                     <a:s r="63">
                        <a:s>ToDate(</a:s>
                        <a:s r="62">
                           <a:s>BirthDateTime</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>and </a:s>
                     <a:s r="65">
                        <a:s>ToDate(</a:s>
                        <a:s r="64">
                           <a:s>AsOf</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="66" locator="43:3-43:53" precision="Year" xsi:type="DurationBetween">
            <operand localId="63" locator="43:17-43:37" xsi:type="ToDate">
               <operand localId="62" locator="43:24-43:36" name="BirthDateTime" xsi:type="OperandRef"/>
            </operand>
            <operand localId="65" locator="43:42-43:53" xsi:type="ToDate">
               <operand localId="64" locator="43:49-43:52" name="AsOf" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="BirthDateTime">
            <operandTypeSpecifier localId="60" locator="42:54-42:61" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="AsOf">
            <operandTypeSpecifier localId="61" locator="42:69-42:76" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="72" locator="46:1-47:46" name="CalendarAgeInYears" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="72">
               <a:s>/*CalendarAgeInYears calculates the calendar age (meaning the age without considering time components) in years as of today.*/define function &quot;CalendarAgeInYears&quot;(BirthDateTime </a:s>
               <a:s r="68">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="71">
                  <a:s r="71">
                     <a:s>CalendarAgeInYearsAt(</a:s>
                     <a:s r="69">
                        <a:s>BirthDateTime</a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="70">
                        <a:s>Today()</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="71" locator="47:3-47:46" name="CalendarAgeInYearsAt" xsi:type="FunctionRef">
            <operand localId="69" locator="47:24-47:36" name="BirthDateTime" xsi:type="OperandRef"/>
            <operand xsi:type="ToDateTime">
               <operand localId="70" locator="47:39-47:45" xsi:type="Today"/>
            </operand>
         </expression>
         <operand name="BirthDateTime">
            <operandTypeSpecifier localId="68" locator="46:52-46:59" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="108" locator="54:1-62:71" name="HospitalizationLocations" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="108">
               <a:s>/* returns list of all locations within an encounter, including locations for immediately prior ED visit. */define function &quot;HospitalizationLocations&quot;(Encounter </a:s>
               <a:s r="76">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="107">
                  <a:s r="107">
                     <a:s>
                        <a:s r="78">
                           <a:s r="77">
                              <a:s>
                                 <a:s>Encounter</a:s>
                              </a:s>
                           </a:s>
                           <a:s> Visit</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="94">
                           <a:s>EDVisit: </a:s>
                           <a:s r="93">
                              <a:s>Last(</a:s>
                              <a:s r="92">
                                 <a:s>
                                    <a:s r="80">
                                       <a:s r="79">
                                          <a:s r="79">
                                             <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Emergency Department Visit&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastED</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="87">
                                    <a:s>where </a:s>
                                    <a:s r="87">
                                       <a:s r="82">
                                          <a:s r="81">
                                             <a:s>LastED</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="82">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="87">
                                          <a:s>ends </a:s>
                                          <a:s r="86">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="85">
                                          <a:s>start of </a:s>
                                          <a:s r="84">
                                             <a:s r="83">
                                                <a:s>Visit</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="84">
                                                <a:s>relevantPeriod</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="91">
                                    <a:s>sort by 
  			</a:s>
                                    <a:s r="90">
                                       <a:s r="89">
                                          <a:s>end of </a:s>
                                          <a:s r="88">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  	)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s r="106">
                        <a:s>return </a:s>
                        <a:s r="105">
                           <a:s>if </a:s>
                           <a:s r="96">
                              <a:s r="95">
                                 <a:s>EDVisit</a:s>
                              </a:s>
                              <a:s> is null</a:s>
                           </a:s>
                           <a:s> then </a:s>
                           <a:s r="98">
                              <a:s r="97">
                                 <a:s>Visit</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="98">
                                 <a:s>facilityLocations</a:s>
                              </a:s>
                           </a:s>
                           <a:s> 
  		else </a:s>
                           <a:s r="104">
                              <a:s>flatten </a:s>
                              <a:s r="103">
                                 <a:s>{ </a:s>
                                 <a:s r="100">
                                    <a:s r="99">
                                       <a:s>EDVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="100">
                                       <a:s>facilityLocations</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>, </a:s>
                                 <a:s r="102">
                                    <a:s r="101">
                                       <a:s>Visit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="102">
                                       <a:s>facilityLocations</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> }</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="107" locator="55:3-62:71" xsi:type="Query">
            <source localId="78" locator="55:3-55:17" alias="Visit">
               <expression localId="77" locator="55:3-55:11" name="Encounter" xsi:type="OperandRef"/>
            </source>
            <let localId="94" locator="56:8-60:4" identifier="EDVisit">
               <expression localId="93" locator="56:17-60:4" xsi:type="Last">
                  <source localId="92" locator="56:22-59:26" xsi:type="Query">
                     <source localId="80" locator="56:22-56:82" alias="LastED">
                        <expression localId="79" locator="56:22-56:75" xmlns:ns3="urn:healthit-gov:qdm:v5_5" dataType="ns3:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes locator="56:47-56:74" name="Emergency Department Visit" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="87" locator="57:6-57:95" xsi:type="And">
                        <operand locator="57:39-57:52" xsi:type="In">
                           <operand locator="57:34-57:37" xsi:type="End">
                              <operand localId="82" locator="57:12-57:32" path="relevantPeriod" scope="LastED" xsi:type="Property"/>
                           </operand>
                           <operand locator="57:39-57:52" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low locator="57:67-57:95" xsi:type="Subtract">
                                 <operand localId="85" locator="57:67-57:95" xsi:type="Start">
                                    <operand localId="84" locator="57:76-57:95" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                                 </operand>
                                 <operand localId="86" locator="57:39-57:44" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="85" locator="57:67-57:95" xsi:type="Start">
                                 <operand localId="84" locator="57:76-57:95" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </high>
                           </operand>
                        </operand>
                        <operand locator="57:39-57:52" xsi:type="Not">
                           <operand locator="57:39-57:52" xsi:type="IsNull">
                              <operand localId="85" locator="57:67-57:95" xsi:type="Start">
                                 <operand localId="84" locator="57:76-57:95" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="91" locator="58:6-59:26">
                        <by localId="90" locator="59:6-59:26" direction="asc" xsi:type="ByExpression">
                           <expression localId="89" locator="59:6-59:26" xsi:type="End">
                              <operand localId="88" locator="59:13-59:26" name="relevantPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <return localId="106" locator="61:4-62:71">
               <expression localId="105" locator="61:11-62:71" xsi:type="If">
                  <condition localId="96" locator="61:14-61:28" xsi:type="IsNull">
                     <operand localId="95" locator="61:14-61:20" name="EDVisit" xsi:type="QueryLetRef"/>
                  </condition>
                  <then localId="98" locator="61:35-61:57" path="facilityLocations" scope="Visit" xsi:type="Property"/>
                  <else localId="104" locator="62:10-62:71" xsi:type="Flatten">
                     <operand localId="103" locator="62:18-62:71" xsi:type="List">
                        <element localId="100" locator="62:20-62:44" path="facilityLocations" xsi:type="Property">
                           <source localId="99" locator="62:20-62:26" name="EDVisit" xsi:type="QueryLetRef"/>
                        </element>
                        <element localId="102" locator="62:47-62:69" path="facilityLocations" scope="Visit" xsi:type="Property"/>
                     </operand>
                  </else>
               </expression>
            </return>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="76" locator="54:54-54:75" xmlns:ns4="urn:healthit-gov:qdm:v5_5" name="ns4:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="125" locator="66:1-70:18" name="EmergencyDepartmentArrivalTime" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="125">
               <a:s>/*Returns the arrival time in the ED for the encounter.  
*/define function &quot;EmergencyDepartmentArrivalTime&quot;(Encounter </a:s>
               <a:s r="109">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="124">
                  <a:s r="124">
                     <a:s>start of </a:s>
                     <a:s r="123">
                        <a:s r="122">
                           <a:s>First(</a:s>
                           <a:s r="121">
                              <a:s>
                                 <a:s r="112">
                                    <a:s r="111">
                                       <a:s>(</a:s>
                                       <a:s r="111">
                                          <a:s>&quot;HospitalizationLocations&quot;(</a:s>
                                          <a:s r="110">
                                             <a:s>Encounter</a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>HospitalLocation</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  		</a:s>
                              <a:s r="116">
                                 <a:s>where </a:s>
                                 <a:s r="116">
                                    <a:s r="114">
                                       <a:s r="113">
                                          <a:s>HospitalLocation</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="114">
                                          <a:s>code</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> in </a:s>
                                    <a:s r="115">
                                       <a:s>&quot;Emergency Department Visit&quot;</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  		</a:s>
                              <a:s r="120">
                                 <a:s>sort by </a:s>
                                 <a:s r="119">
                                    <a:s r="118">
                                       <a:s>start of </a:s>
                                       <a:s r="117">
                                          <a:s>locationPeriod</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  )</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="123">
                           <a:s>locationPeriod</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="124" locator="67:3-70:18" xsi:type="Start">
            <operand localId="123" locator="67:12-70:18" path="locationPeriod" xsi:type="Property">
               <source localId="122" locator="67:12-70:3" xsi:type="First">
                  <source localId="121" locator="67:18-69:35" xsi:type="Query">
                     <source localId="112" locator="67:18-67:72" alias="HospitalLocation">
                        <expression localId="111" locator="67:18-67:56" name="HospitalizationLocations" xsi:type="FunctionRef">
                           <operand localId="110" locator="67:46-67:54" name="Encounter" xsi:type="OperandRef"/>
                        </expression>
                     </source>
                     <where localId="116" locator="68:5-68:63" xsi:type="InValueSet">
                        <code localId="114" locator="68:11-68:31" path="code" scope="HospitalLocation" xsi:type="Property"/>
                        <valueset localId="115" locator="68:36-68:63" name="Emergency Department Visit" xsi:type="ValueSetRef"/>
                     </where>
                     <sort localId="120" locator="69:5-69:35">
                        <by localId="119" locator="69:13-69:35" direction="asc" xsi:type="ByExpression">
                           <expression localId="118" locator="69:13-69:35" xsi:type="Start">
                              <operand localId="117" locator="69:22-69:35" name="locationPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </source>
            </operand>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="109" locator="66:60-66:81" xmlns:ns5="urn:healthit-gov:qdm:v5_5" name="ns5:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="160" locator="83:1-91:31" name="Hospitalization" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="160">
               <a:s>/*Hospitalization returns the total interval for admission to discharge for the given encounter, or for the admission of any immediately prior emergency department visit to the discharge of the given encounter.*/define function &quot;Hospitalization&quot;(Encounter </a:s>
               <a:s r="128">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="159">
                  <a:s r="159">
                     <a:s>
                        <a:s r="130">
                           <a:s r="129">
                              <a:s>
                                 <a:s>Encounter</a:s>
                              </a:s>
                           </a:s>
                           <a:s> Visit</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="146">
                           <a:s>EDVisit: </a:s>
                           <a:s r="145">
                              <a:s>Last(</a:s>
                              <a:s r="144">
                                 <a:s>
                                    <a:s r="132">
                                       <a:s r="131">
                                          <a:s r="131">
                                             <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Emergency Department Visit&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastED</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="139">
                                    <a:s>where </a:s>
                                    <a:s r="139">
                                       <a:s r="134">
                                          <a:s r="133">
                                             <a:s>LastED</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="134">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="139">
                                          <a:s>ends </a:s>
                                          <a:s r="138">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="137">
                                          <a:s>start of </a:s>
                                          <a:s r="136">
                                             <a:s r="135">
                                                <a:s>Visit</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="136">
                                                <a:s>relevantPeriod</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="143">
                                    <a:s>sort by 
  			</a:s>
                                    <a:s r="142">
                                       <a:s r="141">
                                          <a:s>end of </a:s>
                                          <a:s r="140">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  	)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s r="158">
                        <a:s>return </a:s>
                        <a:s r="157">
                           <a:s>Interval[</a:s>
                           <a:s r="153">
                              <a:s>Coalesce(</a:s>
                              <a:s r="149">
                                 <a:s>start of </a:s>
                                 <a:s r="148">
                                    <a:s r="147">
                                       <a:s>EDVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="148">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="152">
                                 <a:s>start of </a:s>
                                 <a:s r="151">
                                    <a:s r="150">
                                       <a:s>Visit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="151">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>, 
  	</a:s>
                           <a:s r="156">
                              <a:s>end of </a:s>
                              <a:s r="155">
                                 <a:s r="154">
                                    <a:s>Visit</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="155">
                                    <a:s>relevantPeriod</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="159" locator="84:3-91:31" xsi:type="Query">
            <source localId="130" locator="84:3-84:17" alias="Visit">
               <expression localId="129" locator="84:3-84:11" name="Encounter" xsi:type="OperandRef"/>
            </source>
            <let localId="146" locator="85:8-89:4" identifier="EDVisit">
               <expression localId="145" locator="85:17-89:4" xsi:type="Last">
                  <source localId="144" locator="85:22-88:26" xsi:type="Query">
                     <source localId="132" locator="85:22-85:82" alias="LastED">
                        <expression localId="131" locator="85:22-85:75" xmlns:ns6="urn:healthit-gov:qdm:v5_5" dataType="ns6:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes locator="85:47-85:74" name="Emergency Department Visit" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="139" locator="86:6-86:95" xsi:type="And">
                        <operand locator="86:39-86:52" xsi:type="In">
                           <operand locator="86:34-86:37" xsi:type="End">
                              <operand localId="134" locator="86:12-86:32" path="relevantPeriod" scope="LastED" xsi:type="Property"/>
                           </operand>
                           <operand locator="86:39-86:52" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low locator="86:67-86:95" xsi:type="Subtract">
                                 <operand localId="137" locator="86:67-86:95" xsi:type="Start">
                                    <operand localId="136" locator="86:76-86:95" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                                 </operand>
                                 <operand localId="138" locator="86:39-86:44" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="137" locator="86:67-86:95" xsi:type="Start">
                                 <operand localId="136" locator="86:76-86:95" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </high>
                           </operand>
                        </operand>
                        <operand locator="86:39-86:52" xsi:type="Not">
                           <operand locator="86:39-86:52" xsi:type="IsNull">
                              <operand localId="137" locator="86:67-86:95" xsi:type="Start">
                                 <operand localId="136" locator="86:76-86:95" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="143" locator="87:6-88:26">
                        <by localId="142" locator="88:6-88:26" direction="asc" xsi:type="ByExpression">
                           <expression localId="141" locator="88:6-88:26" xsi:type="End">
                              <operand localId="140" locator="88:13-88:26" name="relevantPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <return localId="158" locator="90:4-91:31">
               <expression localId="157" locator="90:11-91:31" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="153" locator="90:20-90:91" xsi:type="Coalesce">
                     <operand localId="149" locator="90:29-90:59" xsi:type="Start">
                        <operand localId="148" locator="90:38-90:59" path="relevantPeriod" xsi:type="Property">
                           <source localId="147" locator="90:38-90:44" name="EDVisit" xsi:type="QueryLetRef"/>
                        </operand>
                     </operand>
                     <operand localId="152" locator="90:62-90:90" xsi:type="Start">
                        <operand localId="151" locator="90:71-90:90" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                     </operand>
                  </low>
                  <high localId="156" locator="91:4-91:30" xsi:type="End">
                     <operand localId="155" locator="91:11-91:30" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                  </high>
               </expression>
            </return>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="128" locator="83:45-83:66" xmlns:ns7="urn:healthit-gov:qdm:v5_5" name="ns7:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="163" locator="73:1-74:39" name="HospitalAdmissionTime" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="163">
               <a:s>/*Returns admission time for an encounter or for immediately prior emergency department visit.  */define function &quot;HospitalAdmissionTime&quot;(Encounter </a:s>
               <a:s r="126">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="162">
                  <a:s r="162">
                     <a:s>start of </a:s>
                     <a:s r="161">
                        <a:s>&quot;Hospitalization&quot;(</a:s>
                        <a:s r="127">
                           <a:s>Encounter</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="162" locator="74:3-74:39" xsi:type="Start">
            <operand localId="161" locator="74:12-74:39" name="Hospitalization" xsi:type="FunctionRef">
               <operand localId="127" locator="74:30-74:38" name="Encounter" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="126" locator="73:51-73:72" xmlns:ns8="urn:healthit-gov:qdm:v5_5" name="ns8:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="176" locator="77:1-80:18" name="HospitalArrivalTime" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="176">
               <a:s>/*Returns earliest arrival time for an encounter including any prior ED visit. */define function &quot;HospitalArrivalTime&quot;(Encounter </a:s>
               <a:s r="164">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="175">
                  <a:s r="175">
                     <a:s>start of </a:s>
                     <a:s r="174">
                        <a:s r="173">
                           <a:s>First(</a:s>
                           <a:s r="172">
                              <a:s>
                                 <a:s r="167">
                                    <a:s r="166">
                                       <a:s>(</a:s>
                                       <a:s r="166">
                                          <a:s>&quot;HospitalizationLocations&quot;(</a:s>
                                          <a:s r="165">
                                             <a:s>Encounter</a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>HospitalLocation</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  		</a:s>
                              <a:s r="171">
                                 <a:s>sort by </a:s>
                                 <a:s r="170">
                                    <a:s r="169">
                                       <a:s>start of </a:s>
                                       <a:s r="168">
                                          <a:s>locationPeriod</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  )</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="174">
                           <a:s>locationPeriod</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="175" locator="78:3-80:18" xsi:type="Start">
            <operand localId="174" locator="78:12-80:18" path="locationPeriod" xsi:type="Property">
               <source localId="173" locator="78:12-80:3" xsi:type="First">
                  <source localId="172" locator="78:18-79:35" xsi:type="Query">
                     <source localId="167" locator="78:18-78:72" alias="HospitalLocation">
                        <expression localId="166" locator="78:18-78:56" name="HospitalizationLocations" xsi:type="FunctionRef">
                           <operand localId="165" locator="78:46-78:54" name="Encounter" xsi:type="OperandRef"/>
                        </expression>
                     </source>
                     <sort localId="171" locator="79:5-79:35">
                        <by localId="170" locator="79:13-79:35" direction="asc" xsi:type="ByExpression">
                           <expression localId="169" locator="79:13-79:35" xsi:type="Start">
                              <operand localId="168" locator="79:22-79:35" name="locationPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </source>
            </operand>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="164" locator="77:49-77:70" xmlns:ns9="urn:healthit-gov:qdm:v5_5" name="ns9:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="183" locator="94:1-95:44" name="HospitalizationLengthofStay" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="183">
               <a:s>/*Returns the length of stay in days (i.e. the number of days between admission and discharge) for the given encounter, or from the admission of any immediately prior emergency department visit to the discharge of the encounter*/define function &quot;HospitalizationLengthofStay&quot;(Encounter </a:s>
               <a:s r="179">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="182">
                  <a:s r="182">
                     <a:s>LengthInDays(</a:s>
                     <a:s r="181">
                        <a:s>&quot;Hospitalization&quot;(</a:s>
                        <a:s r="180">
                           <a:s>Encounter</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="182" locator="95:3-95:44" name="LengthInDays" xsi:type="FunctionRef">
            <operand localId="181" locator="95:16-95:43" name="Hospitalization" xsi:type="FunctionRef">
               <operand localId="180" locator="95:34-95:42" name="Encounter" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="179" locator="94:57-94:78" xmlns:ns10="urn:healthit-gov:qdm:v5_5" name="ns10:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="196" locator="98:1-101:18" name="HospitalDepartureTime" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="196">
               <a:s>/*Returns the latest departure time for encounter including any prior ED visit. */define function &quot;HospitalDepartureTime&quot;(Encounter </a:s>
               <a:s r="184">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="195">
                  <a:s r="195">
                     <a:s>end of </a:s>
                     <a:s r="194">
                        <a:s r="193">
                           <a:s>Last(</a:s>
                           <a:s r="192">
                              <a:s>
                                 <a:s r="187">
                                    <a:s r="186">
                                       <a:s>(</a:s>
                                       <a:s r="186">
                                          <a:s>&quot;HospitalizationLocations&quot;(</a:s>
                                          <a:s r="185">
                                             <a:s>Encounter</a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s>HospitalLocation</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  		</a:s>
                              <a:s r="191">
                                 <a:s>sort by </a:s>
                                 <a:s r="190">
                                    <a:s r="189">
                                       <a:s>start of </a:s>
                                       <a:s r="188">
                                          <a:s>locationPeriod</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  )</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="194">
                           <a:s>locationPeriod</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="195" locator="99:3-101:18" xsi:type="End">
            <operand localId="194" locator="99:10-101:18" path="locationPeriod" xsi:type="Property">
               <source localId="193" locator="99:10-101:3" xsi:type="Last">
                  <source localId="192" locator="99:15-100:35" xsi:type="Query">
                     <source localId="187" locator="99:15-99:69" alias="HospitalLocation">
                        <expression localId="186" locator="99:15-99:53" name="HospitalizationLocations" xsi:type="FunctionRef">
                           <operand localId="185" locator="99:43-99:51" name="Encounter" xsi:type="OperandRef"/>
                        </expression>
                     </source>
                     <sort localId="191" locator="100:5-100:35">
                        <by localId="190" locator="100:13-100:35" direction="asc" xsi:type="ByExpression">
                           <expression localId="189" locator="100:13-100:35" xsi:type="Start">
                              <operand localId="188" locator="100:22-100:35" name="locationPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </source>
            </operand>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="184" locator="98:51-98:72" xmlns:ns11="urn:healthit-gov:qdm:v5_5" name="ns11:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="201" locator="104:1-105:33" name="HospitalDischargeTime" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="201">
               <a:s>/*Hospital Discharge Time returns the discharge time for an encounter*/define function &quot;HospitalDischargeTime&quot;(Encounter </a:s>
               <a:s r="197">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="200">
                  <a:s r="200">
                     <a:s>end of </a:s>
                     <a:s r="199">
                        <a:s r="198">
                           <a:s>Encounter</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="199">
                           <a:s>relevantPeriod</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="200" locator="105:3-105:33" xsi:type="End">
            <operand localId="199" locator="105:10-105:33" path="relevantPeriod" xsi:type="Property">
               <source localId="198" locator="105:10-105:18" name="Encounter" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="197" locator="104:51-104:72" xmlns:ns12="urn:healthit-gov:qdm:v5_5" name="ns12:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="274" locator="108:1-128:31" name="HospitalizationWithObservationAndOutpatientSurgeryService" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="274">
               <a:s>/*Hospitalization with Observation and Outpatient Surgery Service returns the total interval from the start of any immediately prior emergency department visit, outpatient surgery visit or observation visit to the discharge of the given encounter.*/define function &quot;HospitalizationWithObservationAndOutpatientSurgeryService&quot;(Encounter </a:s>
               <a:s r="202">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="273">
                  <a:s r="273">
                     <a:s>
                        <a:s r="204">
                           <a:s r="203">
                              <a:s>
                                 <a:s>Encounter</a:s>
                              </a:s>
                           </a:s>
                           <a:s> Visit</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="220">
                           <a:s>ObsVisit: </a:s>
                           <a:s r="219">
                              <a:s>Last(</a:s>
                              <a:s r="218">
                                 <a:s>
                                    <a:s r="206">
                                       <a:s r="205">
                                          <a:s r="205">
                                             <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Observation Services&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastObs</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="213">
                                    <a:s>where </a:s>
                                    <a:s r="213">
                                       <a:s r="208">
                                          <a:s r="207">
                                             <a:s>LastObs</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="208">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="213">
                                          <a:s>ends </a:s>
                                          <a:s r="212">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="211">
                                          <a:s>start of </a:s>
                                          <a:s r="210">
                                             <a:s r="209">
                                                <a:s>Visit</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="210">
                                                <a:s>relevantPeriod</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="217">
                                    <a:s>sort by 
  			</a:s>
                                    <a:s r="216">
                                       <a:s r="215">
                                          <a:s>end of </a:s>
                                          <a:s r="214">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  	)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  	</a:s>
                        <a:s r="228">
                           <a:s>VisitStart: </a:s>
                           <a:s r="227">
                              <a:s>Coalesce(</a:s>
                              <a:s r="223">
                                 <a:s>start of </a:s>
                                 <a:s r="222">
                                    <a:s r="221">
                                       <a:s>ObsVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="222">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="226">
                                 <a:s>start of </a:s>
                                 <a:s r="225">
                                    <a:s r="224">
                                       <a:s>Visit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="225">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  	</a:s>
                        <a:s r="242">
                           <a:s>EDVisit: </a:s>
                           <a:s r="241">
                              <a:s>Last(</a:s>
                              <a:s r="240">
                                 <a:s>
                                    <a:s r="230">
                                       <a:s r="229">
                                          <a:s r="229">
                                             <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Emergency Department Visit&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastED</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="235">
                                    <a:s>where </a:s>
                                    <a:s r="235">
                                       <a:s r="232">
                                          <a:s r="231">
                                             <a:s>LastED</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="232">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="235">
                                          <a:s>ends </a:s>
                                          <a:s r="234">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="233">
                                          <a:s>VisitStart</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="239">
                                    <a:s>sort by 
  			</a:s>
                                    <a:s r="238">
                                       <a:s r="237">
                                          <a:s>end of </a:s>
                                          <a:s r="236">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  	)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  	</a:s>
                        <a:s r="248">
                           <a:s>VisitStartWithED: </a:s>
                           <a:s r="247">
                              <a:s>Coalesce(</a:s>
                              <a:s r="245">
                                 <a:s>start of </a:s>
                                 <a:s r="244">
                                    <a:s r="243">
                                       <a:s>EDVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="244">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="246">
                                 <a:s>VisitStart</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  	</a:s>
                        <a:s r="262">
                           <a:s>OutpatientSurgeryVisit: </a:s>
                           <a:s r="261">
                              <a:s>Last(</a:s>
                              <a:s r="260">
                                 <a:s>
                                    <a:s r="250">
                                       <a:s r="249">
                                          <a:s r="249">
                                             <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Outpatient Surgery Service&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastSurgeryOP</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="255">
                                    <a:s>where </a:s>
                                    <a:s r="255">
                                       <a:s r="252">
                                          <a:s r="251">
                                             <a:s>LastSurgeryOP</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="252">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="255">
                                          <a:s>ends </a:s>
                                          <a:s r="254">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="253">
                                          <a:s>VisitStartWithED</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="259">
                                    <a:s>sort by 
  			</a:s>
                                    <a:s r="258">
                                       <a:s r="257">
                                          <a:s>end of </a:s>
                                          <a:s r="256">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  	)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s r="272">
                        <a:s>return </a:s>
                        <a:s r="271">
                           <a:s>Interval[</a:s>
                           <a:s r="267">
                              <a:s>Coalesce(</a:s>
                              <a:s r="265">
                                 <a:s>start of </a:s>
                                 <a:s r="264">
                                    <a:s r="263">
                                       <a:s>OutpatientSurgeryVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="264">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="266">
                                 <a:s>VisitStartWithED</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>, 
  	</a:s>
                           <a:s r="270">
                              <a:s>end of </a:s>
                              <a:s r="269">
                                 <a:s r="268">
                                    <a:s>Visit</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="269">
                                    <a:s>relevantPeriod</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="273" locator="109:3-128:31" xsi:type="Query">
            <source localId="204" locator="109:3-109:17" alias="Visit">
               <expression localId="203" locator="109:3-109:11" name="Encounter" xsi:type="OperandRef"/>
            </source>
            <let localId="220" locator="110:8-114:4" identifier="ObsVisit">
               <expression localId="219" locator="110:18-114:4" xsi:type="Last">
                  <source localId="218" locator="110:23-113:26" xsi:type="Query">
                     <source localId="206" locator="110:23-110:78" alias="LastObs">
                        <expression localId="205" locator="110:23-110:70" xmlns:ns13="urn:healthit-gov:qdm:v5_5" dataType="ns13:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes locator="110:48-110:69" name="Observation Services" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="213" locator="111:6-111:96" xsi:type="And">
                        <operand locator="111:40-111:53" xsi:type="In">
                           <operand locator="111:35-111:38" xsi:type="End">
                              <operand localId="208" locator="111:12-111:33" path="relevantPeriod" scope="LastObs" xsi:type="Property"/>
                           </operand>
                           <operand locator="111:40-111:53" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low locator="111:68-111:96" xsi:type="Subtract">
                                 <operand localId="211" locator="111:68-111:96" xsi:type="Start">
                                    <operand localId="210" locator="111:77-111:96" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                                 </operand>
                                 <operand localId="212" locator="111:40-111:45" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="211" locator="111:68-111:96" xsi:type="Start">
                                 <operand localId="210" locator="111:77-111:96" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </high>
                           </operand>
                        </operand>
                        <operand locator="111:40-111:53" xsi:type="Not">
                           <operand locator="111:40-111:53" xsi:type="IsNull">
                              <operand localId="211" locator="111:68-111:96" xsi:type="Start">
                                 <operand localId="210" locator="111:77-111:96" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="217" locator="112:6-113:26">
                        <by localId="216" locator="113:6-113:26" direction="asc" xsi:type="ByExpression">
                           <expression localId="215" locator="113:6-113:26" xsi:type="End">
                              <operand localId="214" locator="113:13-113:26" name="relevantPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <let localId="228" locator="115:4-115:88" identifier="VisitStart">
               <expression localId="227" locator="115:16-115:88" xsi:type="Coalesce">
                  <operand localId="223" locator="115:25-115:56" xsi:type="Start">
                     <operand localId="222" locator="115:34-115:56" path="relevantPeriod" xsi:type="Property">
                        <source localId="221" locator="115:34-115:41" name="ObsVisit" xsi:type="QueryLetRef"/>
                     </operand>
                  </operand>
                  <operand localId="226" locator="115:59-115:87" xsi:type="Start">
                     <operand localId="225" locator="115:68-115:87" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                  </operand>
               </expression>
            </let>
            <let localId="242" locator="116:4-120:4" identifier="EDVisit">
               <expression localId="241" locator="116:13-120:4" xsi:type="Last">
                  <source localId="240" locator="116:18-119:26" xsi:type="Query">
                     <source localId="230" locator="116:18-116:78" alias="LastED">
                        <expression localId="229" locator="116:18-116:71" xmlns:ns14="urn:healthit-gov:qdm:v5_5" dataType="ns14:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes locator="116:43-116:70" name="Emergency Department Visit" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="235" locator="117:6-117:76" xsi:type="And">
                        <operand locator="117:39-117:52" xsi:type="In">
                           <operand locator="117:34-117:37" xsi:type="End">
                              <operand localId="232" locator="117:12-117:32" path="relevantPeriod" scope="LastED" xsi:type="Property"/>
                           </operand>
                           <operand locator="117:39-117:52" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low locator="117:67-117:76" xsi:type="Subtract">
                                 <operand localId="233" locator="117:67-117:76" name="VisitStart" xsi:type="QueryLetRef"/>
                                 <operand localId="234" locator="117:39-117:44" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="233" locator="117:67-117:76" name="VisitStart" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                        <operand locator="117:39-117:52" xsi:type="Not">
                           <operand locator="117:39-117:52" xsi:type="IsNull">
                              <operand localId="233" locator="117:67-117:76" name="VisitStart" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="239" locator="118:6-119:26">
                        <by localId="238" locator="119:6-119:26" direction="asc" xsi:type="ByExpression">
                           <expression localId="237" locator="119:6-119:26" xsi:type="End">
                              <operand localId="236" locator="119:13-119:26" name="relevantPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <let localId="248" locator="121:4-121:74" identifier="VisitStartWithED">
               <expression localId="247" locator="121:22-121:74" xsi:type="Coalesce">
                  <operand localId="245" locator="121:31-121:61" xsi:type="Start">
                     <operand localId="244" locator="121:40-121:61" path="relevantPeriod" xsi:type="Property">
                        <source localId="243" locator="121:40-121:46" name="EDVisit" xsi:type="QueryLetRef"/>
                     </operand>
                  </operand>
                  <operand localId="246" locator="121:64-121:73" name="VisitStart" xsi:type="QueryLetRef"/>
               </expression>
            </let>
            <let localId="262" locator="122:4-126:4" identifier="OutpatientSurgeryVisit">
               <expression localId="261" locator="122:28-126:4" xsi:type="Last">
                  <source localId="260" locator="122:33-125:26" xsi:type="Query">
                     <source localId="250" locator="122:33-122:100" alias="LastSurgeryOP">
                        <expression localId="249" locator="122:33-122:86" xmlns:ns15="urn:healthit-gov:qdm:v5_5" dataType="ns15:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes locator="122:58-122:85" name="Outpatient Surgery Service" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="255" locator="123:6-123:89" xsi:type="And">
                        <operand locator="123:46-123:59" xsi:type="In">
                           <operand locator="123:41-123:44" xsi:type="End">
                              <operand localId="252" locator="123:12-123:39" path="relevantPeriod" scope="LastSurgeryOP" xsi:type="Property"/>
                           </operand>
                           <operand locator="123:46-123:59" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low locator="123:74-123:89" xsi:type="Subtract">
                                 <operand localId="253" locator="123:74-123:89" name="VisitStartWithED" xsi:type="QueryLetRef"/>
                                 <operand localId="254" locator="123:46-123:51" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="253" locator="123:74-123:89" name="VisitStartWithED" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                        <operand locator="123:46-123:59" xsi:type="Not">
                           <operand locator="123:46-123:59" xsi:type="IsNull">
                              <operand localId="253" locator="123:74-123:89" name="VisitStartWithED" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="259" locator="124:6-125:26">
                        <by localId="258" locator="125:6-125:26" direction="asc" xsi:type="ByExpression">
                           <expression localId="257" locator="125:6-125:26" xsi:type="End">
                              <operand localId="256" locator="125:13-125:26" name="relevantPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <return localId="272" locator="127:4-128:31">
               <expression localId="271" locator="127:11-128:31" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="267" locator="127:20-127:93" xsi:type="Coalesce">
                     <operand localId="265" locator="127:29-127:74" xsi:type="Start">
                        <operand localId="264" locator="127:38-127:74" path="relevantPeriod" xsi:type="Property">
                           <source localId="263" locator="127:38-127:59" name="OutpatientSurgeryVisit" xsi:type="QueryLetRef"/>
                        </operand>
                     </operand>
                     <operand localId="266" locator="127:77-127:92" name="VisitStartWithED" xsi:type="QueryLetRef"/>
                  </low>
                  <high localId="270" locator="128:4-128:30" xsi:type="End">
                     <operand localId="269" locator="128:11-128:30" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                  </high>
               </expression>
            </return>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="202" locator="108:87-108:108" xmlns:ns16="urn:healthit-gov:qdm:v5_5" name="ns16:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="327" locator="131:1-145:31" name="HospitalizationWithObservation" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="327">
               <a:s>/*Hospitalization with Observation returns the total interval from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/define function &quot;HospitalizationWithObservation&quot;(Encounter </a:s>
               <a:s r="275">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="326">
                  <a:s r="326">
                     <a:s>
                        <a:s r="277">
                           <a:s r="276">
                              <a:s>
                                 <a:s>Encounter</a:s>
                              </a:s>
                           </a:s>
                           <a:s> Visit</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="293">
                           <a:s>ObsVisit: </a:s>
                           <a:s r="292">
                              <a:s>Last(</a:s>
                              <a:s r="291">
                                 <a:s>
                                    <a:s r="279">
                                       <a:s r="278">
                                          <a:s r="278">
                                             <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Observation Services&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastObs</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="286">
                                    <a:s>where </a:s>
                                    <a:s r="286">
                                       <a:s r="281">
                                          <a:s r="280">
                                             <a:s>LastObs</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="281">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="286">
                                          <a:s>ends </a:s>
                                          <a:s r="285">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="284">
                                          <a:s>start of </a:s>
                                          <a:s r="283">
                                             <a:s r="282">
                                                <a:s>Visit</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="283">
                                                <a:s>relevantPeriod</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="290">
                                    <a:s>sort by 
  			</a:s>
                                    <a:s r="289">
                                       <a:s r="288">
                                          <a:s>end of </a:s>
                                          <a:s r="287">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  	)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  	</a:s>
                        <a:s r="301">
                           <a:s>VisitStart: </a:s>
                           <a:s r="300">
                              <a:s>Coalesce(</a:s>
                              <a:s r="296">
                                 <a:s>start of </a:s>
                                 <a:s r="295">
                                    <a:s r="294">
                                       <a:s>ObsVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="295">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="299">
                                 <a:s>start of </a:s>
                                 <a:s r="298">
                                    <a:s r="297">
                                       <a:s>Visit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="298">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  	</a:s>
                        <a:s r="315">
                           <a:s>EDVisit: </a:s>
                           <a:s r="314">
                              <a:s>Last(</a:s>
                              <a:s r="313">
                                 <a:s>
                                    <a:s r="303">
                                       <a:s r="302">
                                          <a:s r="302">
                                             <a:s>[&quot;Encounter, Performed&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Emergency Department Visit&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastED</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="308">
                                    <a:s>where </a:s>
                                    <a:s r="308">
                                       <a:s r="305">
                                          <a:s r="304">
                                             <a:s>LastED</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="305">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="308">
                                          <a:s>ends </a:s>
                                          <a:s r="307">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="306">
                                          <a:s>VisitStart</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  			</a:s>
                                 <a:s r="312">
                                    <a:s>sort by 
  			</a:s>
                                    <a:s r="311">
                                       <a:s r="310">
                                          <a:s>end of </a:s>
                                          <a:s r="309">
                                             <a:s>relevantPeriod</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  	)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	</a:s>
                     <a:s r="325">
                        <a:s>return </a:s>
                        <a:s r="324">
                           <a:s>Interval[</a:s>
                           <a:s r="320">
                              <a:s>Coalesce(</a:s>
                              <a:s r="318">
                                 <a:s>start of </a:s>
                                 <a:s r="317">
                                    <a:s r="316">
                                       <a:s>EDVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="317">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="319">
                                 <a:s>VisitStart</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>, 
  	</a:s>
                           <a:s r="323">
                              <a:s>end of </a:s>
                              <a:s r="322">
                                 <a:s r="321">
                                    <a:s>Visit</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="322">
                                    <a:s>relevantPeriod</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="326" locator="132:3-145:31" xsi:type="Query">
            <source localId="277" locator="132:3-132:17" alias="Visit">
               <expression localId="276" locator="132:3-132:11" name="Encounter" xsi:type="OperandRef"/>
            </source>
            <let localId="293" locator="133:8-137:4" identifier="ObsVisit">
               <expression localId="292" locator="133:18-137:4" xsi:type="Last">
                  <source localId="291" locator="133:23-136:26" xsi:type="Query">
                     <source localId="279" locator="133:23-133:78" alias="LastObs">
                        <expression localId="278" locator="133:23-133:70" xmlns:ns17="urn:healthit-gov:qdm:v5_5" dataType="ns17:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes locator="133:48-133:69" name="Observation Services" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="286" locator="134:6-134:96" xsi:type="And">
                        <operand locator="134:40-134:53" xsi:type="In">
                           <operand locator="134:35-134:38" xsi:type="End">
                              <operand localId="281" locator="134:12-134:33" path="relevantPeriod" scope="LastObs" xsi:type="Property"/>
                           </operand>
                           <operand locator="134:40-134:53" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low locator="134:68-134:96" xsi:type="Subtract">
                                 <operand localId="284" locator="134:68-134:96" xsi:type="Start">
                                    <operand localId="283" locator="134:77-134:96" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                                 </operand>
                                 <operand localId="285" locator="134:40-134:45" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="284" locator="134:68-134:96" xsi:type="Start">
                                 <operand localId="283" locator="134:77-134:96" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </high>
                           </operand>
                        </operand>
                        <operand locator="134:40-134:53" xsi:type="Not">
                           <operand locator="134:40-134:53" xsi:type="IsNull">
                              <operand localId="284" locator="134:68-134:96" xsi:type="Start">
                                 <operand localId="283" locator="134:77-134:96" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="290" locator="135:6-136:26">
                        <by localId="289" locator="136:6-136:26" direction="asc" xsi:type="ByExpression">
                           <expression localId="288" locator="136:6-136:26" xsi:type="End">
                              <operand localId="287" locator="136:13-136:26" name="relevantPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <let localId="301" locator="138:4-138:88" identifier="VisitStart">
               <expression localId="300" locator="138:16-138:88" xsi:type="Coalesce">
                  <operand localId="296" locator="138:25-138:56" xsi:type="Start">
                     <operand localId="295" locator="138:34-138:56" path="relevantPeriod" xsi:type="Property">
                        <source localId="294" locator="138:34-138:41" name="ObsVisit" xsi:type="QueryLetRef"/>
                     </operand>
                  </operand>
                  <operand localId="299" locator="138:59-138:87" xsi:type="Start">
                     <operand localId="298" locator="138:68-138:87" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                  </operand>
               </expression>
            </let>
            <let localId="315" locator="139:4-143:4" identifier="EDVisit">
               <expression localId="314" locator="139:13-143:4" xsi:type="Last">
                  <source localId="313" locator="139:18-142:26" xsi:type="Query">
                     <source localId="303" locator="139:18-139:78" alias="LastED">
                        <expression localId="302" locator="139:18-139:71" xmlns:ns18="urn:healthit-gov:qdm:v5_5" dataType="ns18:PositiveEncounterPerformed" templateId="PositiveEncounterPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                           <codes locator="139:43-139:70" name="Emergency Department Visit" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="308" locator="140:6-140:76" xsi:type="And">
                        <operand locator="140:39-140:52" xsi:type="In">
                           <operand locator="140:34-140:37" xsi:type="End">
                              <operand localId="305" locator="140:12-140:32" path="relevantPeriod" scope="LastED" xsi:type="Property"/>
                           </operand>
                           <operand locator="140:39-140:52" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <low locator="140:67-140:76" xsi:type="Subtract">
                                 <operand localId="306" locator="140:67-140:76" name="VisitStart" xsi:type="QueryLetRef"/>
                                 <operand localId="307" locator="140:39-140:44" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="306" locator="140:67-140:76" name="VisitStart" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                        <operand locator="140:39-140:52" xsi:type="Not">
                           <operand locator="140:39-140:52" xsi:type="IsNull">
                              <operand localId="306" locator="140:67-140:76" name="VisitStart" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="312" locator="141:6-142:26">
                        <by localId="311" locator="142:6-142:26" direction="asc" xsi:type="ByExpression">
                           <expression localId="310" locator="142:6-142:26" xsi:type="End">
                              <operand localId="309" locator="142:13-142:26" name="relevantPeriod" xsi:type="IdentifierRef"/>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <return localId="325" locator="144:4-145:31">
               <expression localId="324" locator="144:11-145:31" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <low localId="320" locator="144:20-144:72" xsi:type="Coalesce">
                     <operand localId="318" locator="144:29-144:59" xsi:type="Start">
                        <operand localId="317" locator="144:38-144:59" path="relevantPeriod" xsi:type="Property">
                           <source localId="316" locator="144:38-144:44" name="EDVisit" xsi:type="QueryLetRef"/>
                        </operand>
                     </operand>
                     <operand localId="319" locator="144:62-144:71" name="VisitStart" xsi:type="QueryLetRef"/>
                  </low>
                  <high localId="323" locator="145:4-145:30" xsi:type="End">
                     <operand localId="322" locator="145:11-145:30" path="relevantPeriod" scope="Visit" xsi:type="Property"/>
                  </high>
               </expression>
            </return>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="275" locator="131:60-131:81" xmlns:ns19="urn:healthit-gov:qdm:v5_5" name="ns19:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="342" locator="148:1-149:100" name="ToDate" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="342">
               <a:s>/*ToDate takes a given DateTime value and returns a DateTime with the time components &quot;zeroed&quot;, and the timezone of the input value, for example, given the DateTime @2012-01-01T06:30:00.0Z, this function will return @2012-01-01T00:00:00.0Z.*/define function &quot;ToDate&quot;(Value </a:s>
               <a:s r="328">
                  <a:s>DateTime</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="341">
                  <a:s r="341">
                     <a:s>DateTime(</a:s>
                     <a:s r="330">
                        <a:s>year from </a:s>
                        <a:s r="329">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="332">
                        <a:s>month from </a:s>
                        <a:s r="331">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>, </a:s>
                     <a:s r="334">
                        <a:s>day from </a:s>
                        <a:s r="333">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                     <a:s r="335">, 0, 0, 0, 0, </a:s>
                     <a:s r="340">
                        <a:s>timezoneoffset from </a:s>
                        <a:s r="339">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="341" locator="149:3-149:100" xsi:type="DateTime">
            <year localId="330" locator="149:12-149:26" precision="Year" xsi:type="DateTimeComponentFrom">
               <operand localId="329" locator="149:22-149:26" name="Value" xsi:type="OperandRef"/>
            </year>
            <month localId="332" locator="149:29-149:44" precision="Month" xsi:type="DateTimeComponentFrom">
               <operand localId="331" locator="149:40-149:44" name="Value" xsi:type="OperandRef"/>
            </month>
            <day localId="334" locator="149:47-149:60" precision="Day" xsi:type="DateTimeComponentFrom">
               <operand localId="333" locator="149:56-149:60" name="Value" xsi:type="OperandRef"/>
            </day>
            <hour localId="335" locator="149:63" valueType="t:Integer" value="0" xsi:type="Literal"/>
            <minute localId="336" locator="149:66" valueType="t:Integer" value="0" xsi:type="Literal"/>
            <second localId="337" locator="149:69" valueType="t:Integer" value="0" xsi:type="Literal"/>
            <millisecond localId="338" locator="149:72" valueType="t:Integer" value="0" xsi:type="Literal"/>
            <timezoneOffset localId="340" locator="149:75-149:99" xsi:type="TimezoneOffsetFrom">
               <operand localId="339" locator="149:95-149:99" name="Value" xsi:type="OperandRef"/>
            </timezoneOffset>
         </expression>
         <operand name="Value">
            <operandTypeSpecifier localId="328" locator="148:32-148:39" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="347" locator="152:1-153:61" name="HospitalizationWithObservationLengthofStay" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="347">
               <a:s>/*Hospitalization with Observation Length of Stay returns the length in days from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/define function &quot;HospitalizationWithObservationLengthofStay&quot;(Encounter </a:s>
               <a:s r="343">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="346">
                  <a:s r="346">
                     <a:s>&quot;LengthInDays&quot;(</a:s>
                     <a:s r="345">
                        <a:s>&quot;HospitalizationWithObservation&quot;(</a:s>
                        <a:s r="344">
                           <a:s>Encounter</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="346" locator="153:3-153:61" name="LengthInDays" xsi:type="FunctionRef">
            <operand localId="345" locator="153:18-153:60" name="HospitalizationWithObservation" xsi:type="FunctionRef">
               <operand localId="344" locator="153:51-153:59" name="Encounter" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="343" locator="152:72-152:93" xmlns:ns20="urn:healthit-gov:qdm:v5_5" name="ns20:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="368" locator="156:1-161:3" name="FirstInpatientIntensiveCareUnit" context="Patient" accessLevel="Public" fluent="false" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="368">
               <a:s>/*First Inpatient Intensive Care Unit returns the first intensive care unit for the given encounter, without considering any immediately prior emergency department visit.*/define function &quot;FirstInpatientIntensiveCareUnit&quot;(Encounter </a:s>
               <a:s r="348">
                  <a:s>&quot;Encounter, Performed&quot;</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="367">
                  <a:s r="367">
                     <a:s>First(</a:s>
                     <a:s r="366">
                        <a:s>
                           <a:s r="351">
                              <a:s r="350">
                                 <a:s>(</a:s>
                                 <a:s r="350">
                                    <a:s r="349">
                                       <a:s>Encounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="350">
                                       <a:s>facilityLocations</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>HospitalLocation</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      </a:s>
                        <a:s r="361">
                           <a:s>where </a:s>
                           <a:s r="361">
                              <a:s r="355">
                                 <a:s r="353">
                                    <a:s r="352">
                                       <a:s>HospitalLocation</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="353">
                                       <a:s>code</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> in </a:s>
                                 <a:s r="354">
                                    <a:s>&quot;Intensive Care Unit&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
        and </a:s>
                              <a:s r="360">
                                 <a:s r="357">
                                    <a:s r="356">
                                       <a:s>HospitalLocation</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="357">
                                       <a:s>locationPeriod</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s r="360"> during </a:s>
                                 <a:s r="359">
                                    <a:s r="358">
                                       <a:s>Encounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="359">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      </a:s>
                        <a:s r="365">
                           <a:s>sort by </a:s>
                           <a:s r="364">
                              <a:s r="363">
                                 <a:s>start of </a:s>
                                 <a:s r="362">
                                    <a:s>locationPeriod</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="367" locator="157:3-161:3" xsi:type="First">
            <source localId="366" locator="157:9-160:37" xsi:type="Query">
               <source localId="351" locator="157:9-157:53" alias="HospitalLocation">
                  <expression localId="350" locator="157:9-157:37" path="facilityLocations" xsi:type="Property">
                     <source localId="349" locator="157:10-157:18" name="Encounter" xsi:type="OperandRef"/>
                  </expression>
               </source>
               <where localId="361" locator="158:7-159:75" xsi:type="And">
                  <operand localId="355" locator="158:13-158:58" xsi:type="InValueSet">
                     <code localId="353" locator="158:13-158:33" path="code" scope="HospitalLocation" xsi:type="Property"/>
                     <valueset localId="354" locator="158:38-158:58" name="Intensive Care Unit" xsi:type="ValueSetRef"/>
                  </operand>
                  <operand localId="360" locator="159:13-159:75" xsi:type="IncludedIn">
                     <operand localId="357" locator="159:13-159:43" path="locationPeriod" scope="HospitalLocation" xsi:type="Property"/>
                     <operand localId="359" locator="159:52-159:75" path="relevantPeriod" xsi:type="Property">
                        <source localId="358" locator="159:52-159:60" name="Encounter" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
               </where>
               <sort localId="365" locator="160:7-160:37">
                  <by localId="364" locator="160:15-160:37" direction="asc" xsi:type="ByExpression">
                     <expression localId="363" locator="160:15-160:37" xsi:type="Start">
                        <operand localId="362" locator="160:24-160:37" name="locationPeriod" xsi:type="IdentifierRef"/>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="348" locator="156:61-156:82" xmlns:ns21="urn:healthit-gov:qdm:v5_5" name="ns21:PositiveEncounterPerformed" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
   </statements>
</library>


